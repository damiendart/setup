# {{ ansible_managed }}
#
# This file was written by Damien Dart, <damiendart@pobox.com>. This is
# free and unencumbered software released into the public domain. For
# more information, please refer to the accompanying "UNLICENCE file.

AddDefaultCharset utf-8
Alias /.well-known/acme-challenge/ "/var/www/html/.well-known/acme-challenge/"
ErrorDocument 401 "<!DOCTYPE html><title>401</title><pre>401</pre>"
ErrorDocument 403 "<!DOCTYPE html><title>403</title><pre>403</pre>"
ErrorDocument 404 "<!DOCTYPE html><title>404</title><pre>404</pre>"
ErrorDocument 410 "<!DOCTYPE html><title>410</title><pre>410</pre>"
FileETag None
ServerTokens ProductOnly
ServerSignature Off
Protocols h2 h2c http/1.1

ServerName {{ webserver__server_name }}

Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"

<IfModule mod_expires.c>
  ExpiresActive on
  ExpiresByType application/xhtml+xml "access plus 0 seconds"
  ExpiresByType text/html "access plus 0 seconds"
  ExpiresByType text/plain "access plus 0 seconds"
  {% if webserver__static_caching is sameas true %}
    ExpiresDefault "access plus 1 week"
  {% else %}
    ExpiresDefault "access plus 0 seconds"
  {% endif %}
</IfModule>

<IfModule mod_mime.c>
  # Force UTF-8 encoding for other file formats.
  AddCharset utf-8 .css .js
  AddType application/javascript js
  AddType application/vnd.ms-fontobject eot
  AddType application/x-font-ttf ttc ttf
  AddType application/x-font-woff woff
  AddType application/x-shockwave-flash swf
  AddType font/opentype otf
  AddType image/x-icon ico
  AddType text/x-c c
  AddType text/x-diff patch
  AddType text/x-python py
  AddType text/x-shellscript sh
</IfModule>

<IfModule mod_ssl.c>
  # The following is based on the intermediate configuration from
  # <https://ssl-config.mozilla.org/>. For more information, see
  # <https://httpd.apache.org/docs/2.4/ssl/ssl_howto.html>.
  SSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384
  SSLHonorCipherOrder off
  SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1
  SSLSessionTickets off
  SSLStaplingCache "shmcb:logs/ssl_stapling(32768)"
  SSLUseStapling On
</IfModule>
